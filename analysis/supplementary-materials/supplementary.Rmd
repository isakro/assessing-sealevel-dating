---
title: "Supplementary material to the paper 'A simulation-based assessment of the relation between Stone Age sites and relative sea-level change along the Norwegian Skagerrak coast'"
author: "Isak Roalkvam"
date: "10/27/2021"
header-includes:
  - \usepackage{placeins}
output: 
  bookdown::pdf_document2:
    toc: true
    fig_caption: yes
    reference_docx: "../templates/template.docx" # Insert path for the DOCX file
    pandoc_args:
    - --lua-filter=../templates/scholarly-metadata.lua
    - --lua-filter=../templates/author-info-blocks.lua
    - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/saa.csl" # Insert path for the bib-style
---

```{r,  include=FALSE, message=FALSE, warning=FALSE}
library(here)
library(tidyverse)
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(echo = FALSE, cache=FALSE)

# Set up so that I can call floatbarrier using regfloat=TRUE in the chunk 
# headings. See: 
# https://gist.github.com/burchill/8873d2ade156b27e92a238a774ce2758
knitr::knit_hooks$set(plot = function (x, options) {
  float_correct <- function(f, y, opts)  {
    if (is.null(opts$regfloat) || opts$regfloat==FALSE)
      paste0(f(y, opts), "\n\n\\FloatBarrier\n")
    else
      f(y, opts)
  }
  if (!is.null(options$out.width) || !is.null(options$out.height) ||
      !is.null(options$out.extra) || options$fig.align != "default" ||
      !is.null(options$fig.subcap)) {
    if (is.null(options$fig.scap))
      options$fig.scap = NA
    return(float_correct(knitr:::hook_plot_tex, x, options))
  }
  return(float_correct(knitr:::hook_plot_md_base, x, options))
})
```

```{r}
# Read in radiocarbon dates to be plotted alongside analysis for
# each site.
rcarbon <- read.csv(here('analysis/data/raw_data/radiocarbon.csv'))

# Read in site data for references in the final table
sitdat <- read.csv(here('analysis/data/raw_data/sites.csv'))

# Read in reported shoreline dates
prevdates <- read.csv((here(
  "analysis/data/raw_data/previous_shoreline_dates.csv"))) %>%
  mutate(start = start * -1,
         end = end * -1) %>%
  dplyr::rename("site_name" = "name")

# Load results of re-dating previously shoreline dated sites
load(here("analysis/data/derived_data/08data.RData"))
```

## Introduction {-}

This document presents the sensitivity analysis performed for informing the number of simulation runs in the analysis of each site, the analysis of each individual site, and the results of re-dating previously shoreline dated sites. All underlying and derived data are available in the online repository for the paper at https://osf.io/7F9SU

## Sensitivity analysis {-}

The first figure shows the result of a test run for the site Hovland 5, where the simulations were run 5000 times to identify when the means for the different distance measures converged. This was used to inform the use of 1000 simulation runs for the subsequent analysis of the other sites, as the means appear to have stabilised sufficiently by this point. Hovland 5 was chosen because the site only has a single ^14^C-date, giving a wide uncertainty range, and because it is located in an area of the landscape where the landscape results in quite large variability on the distance measures.

```{r sample_size,  echo = FALSE, out.width = "500px", warning=FALSE}
include_graphics(here("analysis/figures/sample_size.png"))

```

## Site analyses {-}

The presentation of simulation results for each individual site also has some additional notes pertaining to edits to the DTM, treatment of ^14^C-dates and other relevant information. The sites are presented in alphabetical order. 

Stone Age sites for which no spatial data was readily available are Frebergsvik A--C [@mikkelsen1975], Nedre Holtan [@sjursjeike], Rugtvedt [@odgaard1994], Tangen [@glorstad2005], and Torsrød [@østmo1975]. These sites are therefore not included in the analysis. Furthermore, @nielsen2021b has recently interpreted features from the otherwise younger sites Bratsberg and Larønningen as possibly related to farming activity in the Early Neolithic. However, given the limited number of features, the lack of any artefacts directly related to these, and the therefore somewhat speculative nature of this suggestion, the sites are kept out of the analysis here.

The first plot on the first row for each site shows all calibrated radiocarbon dates from the Stone Age associated with the site (see analysis/data/raw_data/radiocarbon.csv for all dates, including those falling outside of the period). The fill colour of the radiocarbon dates indicates whether they are interpreted as belonging to the same phase, and each sum indicates that multiple dates for a phase have been modelled using the Boundary function and then summed using OxCal. Each phase is assumed to be independent of other phases. A red outline indicates that the date(s) were not seen as related to the artefact inventory in the original report. The second plot on the first row displays the site location in the present day landscape on the edited DTM (i.e. highways and railways impacting the adjusted sea-level have been removed, and elevation values are interpolated from the surroundings; see main text and analysis/script/03script.R). The third plot on the first row shows the site location within the study area relative to the isobases of the shoreline displacement curves in use.

Subsequent rows for each site then show the simulation results. The first plot on these rows shows the probability density function from which site dates were drawn during simulation. The second plot shows the result of the simulation runs, where the intensity of the colour indicates the number of times the sea was simulated to be present at any given location. The third plot displays a violin plot of the measured distances between site and shore-line across all simulation runs.

```{r adalvestre1,  echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}

include_graphics(here("analysis/figures/adalvestre1.png"))

filter(rcarbon, site_name  == "Adal vestre 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Adal vestre 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Adal vestre 1 is situated close to a field, but this does not appear to have resulted in any relevant changes to the terrain.

```{r dalvestre2,  echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/adalvestre2.png"))

filter(rcarbon, site_name  == "Adal vestre 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Adal vestre 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

Adal vestre 2 has a similar location in the present day landscape to that of Adal vestre 1 (above).

```{r alveberget8,  echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/alveberget8.png"))

filter(rcarbon, site_name  == "Alveberget 8") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Alveberget 8", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)


```

The artefact inventory at Alveberget 8 matches the radiocarbon dates [@mansrud2021]. The site is located in an undisturbed area of the DTM.

```{r anvik,  echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/anvik.png"))

filter(rcarbon, site_name  == "Anvik") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Anvik", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)


```

Anvik [@eymundsson2014a] is situated by the highway and a smaller road. Neither appear to impact the simulation results. The dated fireplace is not seen as related to lithic material, which is believed to hail from the latest part of the Early Mesolithc (c. 8500-8250 BCE).

```{r auve,  echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/auve.png"))

filter(rcarbon, site_name  == "Auve") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Auve", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)


```

The site limit for Auve was drawn manually based on the description in the publication of the site and the site geometry available in the database Askeladden. The site is located in and around an intersection of the road, parts of the area has been levelled and farmed, and an area to north-west of the site has reportedly been affected by land-slides [@ostmo2008, 16--29] , but the extent of this is difficult to ascertain based on maps of the area. As the simulation results appear reasonable [see also map in @ostmo2008, fig.142], nothing was done to try to correct for these factors. 

```{r bakke, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/bakke.png"))

filter(rcarbon, site_name  == "Bakke") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Bakke", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The radiocarbon date to the Stone Age is not related to the site inventory at Bakke, which is distinctly Early Mesolithic in character [@nyland2012b].

```{r brunstad24, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/brunstad24.png"))

filter(rcarbon, site_name  == "Brunstad 24") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Brunstad 24", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Typological indicators in the lithic inventory from Brunstad 24 matches the ^14^C-dates [@danielsen2018]. The footprint of a large building structure covering a large part of the site from the south required editing of the DTM. Apart from that the landscape appears relatively undisturbed. 8 fragments from a pot could potentially correspond with the ^14^C-dates to the Late Bronze Age and Early Iron Age, but given their uncetain nature and the limited number of sherds, this was disregarded here.

```{r brunstad25, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/brunstad25.png"))

filter(rcarbon, site_name  == "Brunstad 25") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Brunstad 25", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

As with Brunstad 24 (above), the artefact inventory from Brunstad 25 matches the radiocarbon dates [@reitan2018], and the building structure covering the southern part of the site had impacted the DTM and had to be removed. 

```{r dordal, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}

include_graphics(here("analysis/figures/dordal.png"))

filter(rcarbon, site_name  == "Dørdal") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Dørdal", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The ^14^C-dates from two fireplaces at Dørdal are not related to the lithic inventory, where there are no typological indicators pointing the Late Mesolithic. The report suggest that the results might reflect a contamination through a natural process of some sort [@solheim2017].

```{r dybdalshei1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/dybdalshei1.png"))

filter(rcarbon, site_name  == "Dybdalshei 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Dybdalshei 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

Dybdalshei 1 was subject to a very limited excavation [@granum2018], and the lack of data might therefore lead one to question whether or not the site actually represent a settlement area. Furthermore, what little lithic material was retrieved is too generic to offer any typological support to the radiocarbon dates of the dated cooking pits. Nonetheless, the site and the ^14^C-dates are still treated the same way as the other sites. This is based on the agreement between the ^14^C-dates ans the spatial relation between the lithic artefacts and the features, which offers some additional support to the notion that the cooking pits represent remnants from visits in the Mesolithic.

```{r dybdalshei2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/dybdalshei2.png"))

filter(rcarbon, site_name  == "Dybdalshei 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Dybdalshei 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The situation on Dybdalshei 2 is similar to that on Dybdalshei 1 [above, @granum2018], but with only a single date from a single feature and no lithics, the site is not included in subsequent analysis.

```{r gunnarsrod4, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod4.png"))

filter(rcarbon, site_name  == "Gunnarsrød 4") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 4", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The rock-shelter site Gunnarsrød 4 [@reitan2014k], and Gunnarsrød 5 (below), were situated close to where the railway runs today, and therefore required editing of the DTM. Based on maps from the report, this appears to have given adequate, although not perfect results [@reitan2014k, fig.14.7.1]. The date from the bottom of the cultural layer was seen as possibly impacted by old-wood effect, a notion that is in line with the simulation results, as this date would have the site located beneath the sea-level [@reitan2014k].

```{r gunnarsrod5, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod5.png"))

filter(rcarbon, site_name  == "Gunnarsrød 5") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 5", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The location of Gunnarsrød 5 is today situated at the exit of a railway tunnel. The construction of the tunnel entrance has lead to a removal of parts of what used to be a hill on which the site was situated [@reitan2014d]. While the editing and interpolation of the DTM appears to give reasonable results for the rest of the flatter marsh area where the railway runs today (see also Gunnarsrød 4, above), the site itself would have been situated slightly higher. This has likely led to the negative values on the distance measures. In combination, the simulation results and the site map in the report [@reitan2014d, fig.9.1] indicate that the site would not have been situated any significant distance from the shoreline. The negative values have therefore been set to zero for the final aggregative analysis. A note can also be made on the date that is seen as unrelated to the artefact inventory. This is from charcoal from a pit with ceramics which had a far younger date. The date was therefore interpreted as the result of contamination of some kind.

```{r gunnarsrod6a, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod6a.png"))

filter(rcarbon, site_name  == "Gunnarsrød 6a") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 6a", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The ^14^C-date to the Neolithic from Gunnarsrød 6a is not related to the lithic inventory on the site, which is clearly Mesolithic [@carrasco2014].

```{r gunnarsrod6b, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod6b.png"))

filter(rcarbon, site_name  == "Gunnarsrød 6b") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 6b", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

As with Gunnarsrød 6a above, the ^14^C-date to the Neolithic from Gunnarsrød 6b is not related to the Mesolithic inventory on the site [@carrasco2014].

```{r gunnarsrod7, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod7.png"))

filter(rcarbon, site_name  == "Gunnarsrød 7") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 7", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

The lithic inventory from Gunnarsrød 7 is of a Middle Mesolithic character and does not match the ^14^C-dates [@fossum2014b].

```{r gunnarsrod10, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/gunnarsrod10.png"))

filter(rcarbon, site_name  == "Gunnarsrød 10") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Gunnarsrød 10", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)

```

Based on the location of Gunnarsrød 10 on a steep ledge indicating a shore-bound location, and the site inventory, the ^14^C-date is not believed to be related to the main occupation of the site [@reitan2014l].

```{r hegnavest1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hegnavest1.png"))

filter(rcarbon, site_name  == "Hegna vest 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hegna vest 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Example site from the main text. Hegna vest 1 has been visited multiple times throughout prehistory. The lithic inventory is distinctly Middle Mesolithic and Neolithic in character, with some finds that might be even younger. This is also reflected in the pottery finds, which are deemed to be from the Bronze Age--Early Iron Age. The ^14^C-date to the Late Mesolithic is therefore considered unrelated to the main occupation of the site, as it cannot be related to any elements of the site inventory [@fossum2017a]. The highway runs right by Hegna vest 1 and has been removed. This seem successful in that it doesn't appear to impact the simulated sea-levels. 

```{r hegnavest2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hegnavest2.png"))

filter(rcarbon, site_name  == "Hegna vest 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hegna vest 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

As with Hegna vest 1 (above), Hegna vest 2 has been used throughout prehistory. This includes the Middle Mesolithic, the Neolithc, the Bronze Age and the Early Iron Age. The ^14^C-dates are believed to be related to the site activities [@fossum2017]. Hegna vest 2 is located where the highway runs today. This was removed, which appears to have been successful in relation to the simulation results.

```{r hegnavest3, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hegnavest3.png"))

filter(rcarbon, site_name  == "Hegna vest 3") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hegna vest 3", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Along with Hegna vest 2 (above), Hegna vest 3 was situated where the highway runs today. The highway has been removed, and it would seem successfully so, as related to the sea-level adjustments. The ^14^C-date to the Middle Mesolithic fits well with the lithic inventory [@eigeland2017]. 

```{r hesthagc2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hesthagc2.png"))

filter(rcarbon, site_name  == "Hesthag C2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hesthag C2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Hesthag C2 has seen repeated use, as evidenced both by ^14^C-dates and the artefact inventory [@viken2018e]. While only a few finds can be typologically dated to the Late Mesolithic, these were deemed substantial enough to trust the two ^14^C-dates to the period [@viken2018e, 271]. No editing of the DTM was necessary.

```{r hesthagc4, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hesthagc4.png"))

filter(rcarbon, site_name  == "Hesthag C4") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hesthag C4", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Typology and radiocarbon date match, and there are no modern disturbances in the vicinity of Hesthag C4 [@viken2018b]. The second ^14^C-date is a reference date of charcoal from a context believed not be anthropogenic. 

```{r hovland1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hovland1.png"))

filter(rcarbon, site_name  == "Hovland 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hovland 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

It was noted in the report that it is uncertain how close to the shoreline Hovland 1 would have been situated, based on the ^14^C-dates [@olsen2013b]. The earliest dates match the lithic inventory. The later date is the only indication of activity from the Early Bronze Age/Early Iron Age. The site is not located far from the highway, which was also edited for the analysis of Hovland 1 and 4, as well as Torstvet (see below). It could be noted that all of the Hovland sites and Torstvet (sites from the E18 Brunlanes project) are located a relatively short vertical distance from the sea, but the terrain makes this result in quite high horizontal and topographic distances.   

```{r hovland3, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hovland3.png"))

filter(rcarbon, site_name  == "Hovland 3") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hovland 3", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Hovland 3 is securely dated both typologically and radiometrically [@solheim2013]. The site located right by the highway, but this appears to have been successfully removed.

```{r hovland4, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hovland4.png"))

filter(rcarbon, site_name  == "Hovland 4") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hovland 4", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Hovland 4 is well-dated both typologically and with ^14^C-dates to the Mesolithic [@mansrud2013a]. It has a similar location to that of Hovland 3 (above), and editing of the highway seems to have been successful. 

```{r hovland5, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hovland5.png"))

filter(rcarbon, site_name  == "Hovland 5") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hovland 5", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Hovland 5 is situated more withdrawn from the highway than the other Hovland sites (above), and the DTM did therefore not require any editing. The site only has a single ^14^C-date to the Stone Age, but this does match the typological indicators of the assemblage [@mansrud2013]. 

```{r hydal4, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/hydal4.png"))

filter(rcarbon, site_name  == "Hydal 4") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Hydal 4", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The lithic inventory from Hydal 4 is distinctly Middle Mesolithic in character, and therefore does not match the ^14^C-dates to the Late Mesolithic [@koxvold2017e]. The simulation of the sea-level does not appear impacted by any modern disturbances.

```{r krogenesd1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/krogenesd1.png"))

filter(rcarbon, site_name  == "Krøgenes D1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Krøgenes D1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

All ^14^C-dates from Krøgenes D1 are believed to be related to use of the site, which has been reused multiple times over a long time-span [@reitan2018]. This is evidenced by the artefact inventory as well. To what degree the different dates are related to different or the same settlement phases is difficult to ascertain, but is here, as with for the rest of the sites, simply based on grouping dates overlapping with 99.7% probability. The site is situated around 100 meter from a road to the south, but this does not appear to impact simulation results, which is therefore left unedited in the DTM.

```{r krogenesd2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/krogenesd2.png"))

filter(rcarbon, site_name  == "Krøgenes D2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Krøgenes D2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Dates match the artefact inventory of Krøgenes D2, with the exception of the oldest date which is not seen as relevant for the main occupation of the site, in part also due to the large error [@mansrud2018b]. The site location is similar to that of Krøgenes D1 (above), and did not require any editing of the DTM.

```{r kvastada1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/kvastada1.png"))

filter(rcarbon, site_name  == "Kvastad A1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Kvastad A1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

^14^C-date and lithic inventory at Kvastad A1 correspond with a date to the end of the Early Mesolithic [@stokke2018]. The highway to north of the site is clearly visible on the DTM, but does not impact the simulation results.

```{r kvastada2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/kvastada2.png"))

filter(rcarbon, site_name  == "Kvastad A2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Kvastad A2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The two find areas at Kvastad A2 are predominantly Mesolithic (to the south-west) and Neolithic (to the north-east) but were treated in combination here as one Mesolithic date was from the Neolithic area [@stokke2018b]. There is also a late Neolithic element in the lithic inventory that is not reflected in the ^14^C-dates. As with Kvastad A1 (above) the highway runs north of the site, clearly visible on the DTM, but does not impact the simulation results.

```{r kvastada4, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/kvastada4.png"))

filter(rcarbon, site_name  == "Kvastad A4") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Kvastad A4", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

While there are a few elements of the lithic inventory from Kvastad A4 that could be related to the late Middle Mesolithic ^14^C-date, it is not related to the main visits to the site, which are Early Mesolithic in character [@darmark2018c]. The highway runs over the site today, but this is not relevant for the shore-line reconstruction done here.

```{r kvastada9, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/kvastada9.png"))

filter(rcarbon, site_name  == "Kvastad A9") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Kvastad A9", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The Stone Age date from Kvastad A9 is not related to the Early Mesolithic assemblage [@darmark2018b]. The highway running by the site does not seem relevant to the simulation results. 

```{r langangenv1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langangenv1.png"))

filter(rcarbon, site_name  == "Langangen Vestgård 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langangen Vestgård 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Langangen Vestgård 1 is a securely dated site with both ^14^C-dates and typology [@melvold2014]. No modern disturbances appear relevant for the sea-level adjustment.

```{r langangenv3, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langangenv3.png"))

filter(rcarbon, site_name  == "Langangen Vestgård 3") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langangen Vestgård 3", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Typology of the site inventory from Langangen Vestgård 3 match the ^14^C-date [@eggen2014a]. Typological indicators are too coarse to offer any insight on the division into two phases done here for the ^14^C-dates (see main text). No editing of the DTM was necessary.

```{r langangenv5, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langangenv5.png"))

filter(rcarbon, site_name  == "Langangen Vestgård 5") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langangen Vestgård 5", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE) %>% 
  kable_styling(latex_options="scale_down")
```

Langangen Vestgård 5. Typology match the ^14^C-dates and a division into two settlement phases, one Late Mesolithic and one Early Neolithic [@reitan2014b]. No editing of the DTM deemed necessary.

```{r langangenv6, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langangenv6.png"))

filter(rcarbon, site_name  == "Langangen Vestgård 6") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langangen Vestgård 6", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Pottery and the lithic inventory of Langanven Vestgård 6 match ^14^C-dates to the Early Neolithic [@reitan2014c]. Nothing in the artefact inventory could be related to the Late Neolithic date. The DTM did not require editing.

```{r langangenv7, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langangenv7.png"))

filter(rcarbon, site_name  == "Langangen Vestgård 7") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langangen Vestgård 7", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Langangen Vestgård 7 is represented by a cooking pit found on one of two terraces scattered with lithics that was not known and not originally part of the excavation project [@reitan2014j]. The site was therefore only investigated to a limited degree. However, the material does typologically match the ^14^C-date. 

```{r langemyr, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/langemyr.png"))

filter(rcarbon, site_name  == "Langemyr") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Langemyr", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Langemyr is typologically and radiometrically dated to the Middle Mesolithic [@koxvold2018a]. A construction area just south the site was removed. This is the same highway-project and raster editing that was done for some of the Hovland sites above.

```{r lovas1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/lovas1.png"))

filter(rcarbon, site_name  == "Løvås 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Løvås 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Løvås 1. No editing of the raster appeared to be necessary. Interestingly only the Løvås sites were simulated to be situated beneath the sea-level. The typologically secure inventory combined with the many overlapping dates from various features does indicate that the issue is with the displacement curve and not the dating of the site. Similar situation to that on Løvås 2 and 3 (below).

```{r lovas2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/lovas2.png"))

filter(rcarbon, site_name  == "Løvås 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Løvås 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE) %>% 
  kable_styling(latex_options="scale_down")
```

Løvås 2. Similar situation to that on Løvås 1 and 3 (above and below).

```{r lovas3, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
knitr::include_graphics(here("analysis/figures/lovas3.png"))

filter(rcarbon, site_name  == "Løvås 3") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Løvås 3", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Similar situation to that on Løvås 1 and 2 (above).

```{r lunaveien, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/lunaveien.png"))

filter(rcarbon, site_name  == "Lunaveien") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Lunaveien", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Lunaveien is a grave cairn site, and the report states that it is unlikely that any of the finds relate to a settlement [@reitan2010]. The results have therefore been excluded from the aggregative analysis.

```{r nauena, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/nauena.png"))

filter(rcarbon, site_name  == "Nauen A") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Nauen A", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Typology of the lithic inventory on Nauen A points to a Late Mesolithic date [@persson2008]. The later date is seen as related to the establishment of a field for grazing or agriculture, which is also supported by younger dates that fall outside the analysis here. A section of the highway located a few hundred meters to the south was pre-emptively edited in the DTM. This does not appear to be relevant for the simulated sea-level.

```{r nauenc, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/nauenc.png"))

filter(rcarbon, site_name  == "Nauen C") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Nauen C", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The typological indicators of the lithic inventory from Nauen C match the earliest dates [@persson2008]. As with Nauen A, above, the DTM was edited pre-emptively and does not appear to have been necessary.

```{r nordby1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/nordby1.png"))

filter(rcarbon, site_name  == "Nordby 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Nordby 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Nordby 1 is dated to the Late Neolithic, Bronze Age and Early Iron Age [@gjerpe2008b] with long-house 4 dated to the Late Neolithic. Lithics and pottery finds support the ^14^C-dates. The site located on what is today a highway which was edited also for Nordby 52 (below), but is not relevant for the sea-level reconstruction for Nordby 1.

```{r nordby52, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/nordby52.png"))

filter(rcarbon, site_name  == "Nordby 52") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Nordby 52", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Nordby 52 is a rock-shelter that has been visited throughout prehistory [@gjerpe2008]. The site has a clear typological date to both of the Stone Age periods defined by the ^14^C-dates treated here. The site is located by where the highway runs today (see also Nordby 1 above). Edit appears to have been successful.

```{r pauler1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/pauler1.png"))

filter(rcarbon, site_name  == "Pauler 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Pauler 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Pauler 1 has a distinctly Early Mesolithic artefact inventory that is not related to the ^14^C-dates [@schallerahrberg2012]. 

```{r pauler2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/pauler2.png"))

filter(rcarbon, site_name  == "Pauler 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Pauler 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

As with Pauler 1 (above), Pauler 2 has a distinctly Early Mesolithic artefact inventory that is not related to the ^14^C-dates [@nyland2012].

```{r pjonkerodr1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/pjonkerodr1.png"))

filter(rcarbon, site_name  == "Pjonkerød R1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Pjonkerød R1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The lithic inventory from Pjonkerød R1 is consistent with the ^14^C-date [@carrasco2015]. The site is situated by a large gravel pit today, which has been fairly successfully edited. However, as the few negative values in the results are likely to result from the interpolation process and the fact that this is a quite large area, as opposed to issues with the displacement curves or ^14^C-dates, the negative values were forced to zero for the aggregative analysis.

```{r prestemoen1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/prestemoen1.png"))

filter(rcarbon, site_name  == "Prestemoen 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Prestemoen 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Prestemoen 1 has a lithic inventory consistent with the ^14^C-dates [@persson2014]. The site is situated by a gravel pit that is clearly visible on the DTM to the north-east of the site. This was not edited as it has not impacted the simulated distance between site and sea. The landscape surrounding the site would, however, have been very different in the Mesolithic [@persson2014, fig. 10.20].

```{r ragnhildrod, echo = FALSE, out.width = "500px", regfloat=TRUE, warning = FALSE, warning=FALSE}
include_graphics(here("analysis/figures/ragnhildrod.png"))
 
filter(rcarbon, site_name  == "Ragnhildrød") %>% 
   select(lab_code, c14_bp, error, material, context) %>% 
    kable(caption = "Ragnhildrød", col.names = c("ID",
                     "\\textsuperscript{14}C BP",
                     "Error",
                     "Material",
                     "Context"),
         booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The earliest ^14^C-date, from an uncertain context, is argued to be older and not match the typological indicators in the inventory from Ragnhildrød [@mjaerum2012, 50, 71]. The post-hole dated to the Late Neolithic/Bronze Age could be related to a single find of a pressure flaked object, but was not given much weight in the report [@mjaerum2012, 76].

```{r rodbol54, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/rodbol54.png"))

filter(rcarbon, site_name  == "Rødbøl 54") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Rødbøl 54", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Lithic inventory match the ^14^C-date from Rødbøl 54 [@mansrud2008]. The site is situated where the highway runs today, which required editing and which is deemed to have been successful.  

```{r rognlien, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/rognlien.png"))

filter(rcarbon, site_name  == "Rognlien") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Rognlien", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Rognlien was originally excavated in [@ingstad1970]. The site limit has been manually defined based on the description given in the report and the spatial geometry of the site as defined in the database Askeladden. The manually defined limit could be slightly off, but should match the elevation of the site given in the publication [@ingstad1970].The ^14^C-dates from the original excavation was not seen as contemporaneous with the lithic material on the site. Burnt elk bone from the original excavation was therefore recently subjected to radiocarbon dating and is believed to match the occupation of the site [pers.comm. Steinar Solheim, also provided in @stokke2017, 24]. Given the 0m distance that the older dates give here, however, there does not appear to be grounds on which to reject the older dates based on sea-level change. 

```{r sageneb1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/sageneb1.png"))

filter(rcarbon, site_name  == "Sagene B1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Sagene B1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

^14^C-dates from Sagene B1 do not match the Early Mesolithic inventory of the site [@viken2018]. The wide discrepancy of the dates from the the post-holes also led @viken2018 to suggest that these features might actually be non-anthropogenic and that they could instead be related to trees that have grown on the site.

```{r sageneb2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/sageneb2.png"))

filter(rcarbon, site_name  == "Sagene B2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Sagene B2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The ^14^C-dates from Sagene B2 do not match the clearly Early Mesolithic inventory of the site [@darmark2018a].

```{r solum3, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/solum3.png"))

filter(rcarbon, site_name  == "Solum 3") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Solum 3", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Solum 3 is a Late Neolithic and Early Bronze Age site, with ^14^C-dates matching the lithic inventory [@fossum2014d].

```{r stokkep1, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/stokkep1.png"))

filter(rcarbon, site_name  == "Stokke/Polland 1") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Stokke/Polland 1", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The artefact inventory from Stokke/Polland 1, containing both lithics and ceramics, indicates visits in the Late Mesolithic as well as the Early Neolithic [@koxvold2017i]. Date groups were therefore manually separated, even though they overlap at 99.7% probability. The site is located right by the highway to the east, which was edited for the other Stokke/Polland sites, but this does not appear relevant for the reconstruction of the sea-level at Stokke/Polland 1, which would have reached the site from the west.

```{r stokkep5, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/stokkep5.png"))

filter(rcarbon, site_name  == "Stokke/Polland 5") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Stokke/Polland 5", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

The ^14^C-dates matches the lithic inventory from Stokke/Polland 5 [@mansrud2017]. The site is located where the highway runs today. This appears to have been successfully edited. The excavated area is more extensive (field A--C in the report) that what is used as the site limit here, but the relation between the different areas is not clear. Field A, used as the site limit here, holds all the dated features.

```{r stokkep8, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/stokkep8.png"))

filter(rcarbon, site_name  == "Stokke/Polland 8") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Stokke/Polland 8", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Stokke/Polland 8 have corresponding lithic inventory and ^14^C-date [@fossum2017c]. The site is situated just east of where the highway runs today. This appears to have been successfully edited [cf. @fossum2017c, fig.28.3].

```{r torstvet, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/torstvet.png"))

filter(rcarbon, site_name  == "Torstvet") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Torstvet", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Typology of lithics match the ^14^C-dates from Torstvet [@mansrud2013b]. The site is located where the highway runs today. This appears to have been successfully edited, although there is a possibility that this has led to the sea-level being simulated sightly further away from the site than what would otherwise have been the case. However, as with he Hovland-sites above, this appears to rather follow from the general topography of the landscape which makes the reconstruction more uncertain than in areas with a higher relief.

```{r trondalen, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/trondalen.png"))

filter(rcarbon, site_name  == "Trondalen") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Trondalen", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

^14^C-dates match the typological indicators in the artefact assemblage at Trondalen [@mansrud2018c]. No disturbances required editing in the DTM.

```{r tverdal, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/tverdal.png"))

filter(rcarbon, site_name  == "Tverdal") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Tverdal", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Tverdal is an unpublished site. Preliminary analysis indicates that radiocarbon dates and typological indicators match. The area surrounding the site appears relatively undisturbed by modern activity.

```{r vallermyrene1a, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/vallermyrene1a.png"))

filter(rcarbon, site_name  == "Vallermyrene 1a") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Vallermyrene 1a", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Vallermyrene 1 was divided into 1a and 1b based on elevation difference, typology and 14C-dates [@reitan2014f]. Vallermyene 1a is the oldest of the two. Although situated not that far from the railway, the area immediatly surrounding the site has not been disturbed in a way that appears to impact the reconstruction of the past sea-level. 

```{r vallermyrene1b, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/vallermyrene1b.png"))

filter(rcarbon, site_name  == "Vallermyrene 1b") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Vallermyrene 1b", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Vallermyrene 1b is the younger than Vallermyrene 1a (above), as indicated both by the radiocarbon date, typology and elevation [@reitan2014f]. The DTM did not require editing.

```{r vallermyrene2, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/vallermyrene2.png"))

filter(rcarbon, site_name  == "Vallermyrene 2") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Vallermyrene 2", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Vallermyrene 2 was a large site situated in a field [@reitan2014o]. The site has ^14^C-dates and artefacts dating occupations at the sites to multiple phases throughout prehistory, including the Bronze Age and phases up until the Viking Age. The Stone Age activity on the site was evidenced by 359 lithics and a fireplace dated to the Early Neolithic. Given it's uncertain extent, the site limit used here is defined by the fireplace.

```{r vallermyrene4a, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/vallermyrene4a.png"))

filter(rcarbon, site_name  == "Vallermyrene 4a") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Vallermyrene 4a", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Vallermyrene 4 was, as with Vallermyrene 1 (above), divided into Vallermyrene 4a and 4b based on radiocarbon dates and differences in elevation [@eigeland2014]. Typologically the sites are identical, and match the ^14^C-dates. Vallermyrene 4a is the older of the two and was less disturbed by modern acitivity before the excavation. The railway runs just east and north-east of the site and had to be removed. In addition, what appears to be a gravel pit was located to the south-west. Both railway and gravel pit appear to have been adequately edited in the employed DTM.

```{r vallermyrene4b, echo = FALSE, out.width = "500px", regfloat=TRUE, warning=FALSE}
include_graphics(here("analysis/figures/vallermyrene4b.png"))

filter(rcarbon, site_name  == "Vallermyrene 4b") %>% 
  select(lab_code, c14_bp, error, material, context) %>% 
   kable(caption = "Vallermyrene 4b", col.names = c("ID",
                    "\\textsuperscript{14}C BP",
                    "Error",
                    "Material",
                    "Context"),
        booktabs = TRUE,  linesep = c(""), escape = FALSE)
```

Vallermyrene 4b is slightly younger than Vallermyrene 4a (above). Typology and radiocarbon dates match [@eigeland2014]. The DTM was edited to remove the railway track running by the site and a gravel pit.

## Numerical result of re-dating {-}

```{r}
# Find 95% HDR for shoreline dates and reorder the sitesby median date 
# (Taken directly from 08redate.R)

bdates3 <- rbind(bdates, bdates2)

hdrdat <- data.frame()
for(i in 1:length(unique(bdates3$site_name))){
  dat <-hdrcde::hdr(den = list("x" = bdates3[bdates3$site_name ==
                                                unique(bdates3$site_name)[i],
                                              "years"][[1]],
                               "y" = bdates3[bdates3$site_name ==
                                                unique(bdates3$site_name)[i],
                                              "probability"][[1]]), prob = 95)
  segdat <- data.frame(t(dat$hdr))
  groupdat <- data.frame(matrix(nrow = length(segdat[seq(1, nrow(segdat), 2),]),
                                ncol = 5))
  names(groupdat) <- c("site_name", "start", "end", "group", "year_median")

  groupdat$site_name <-  unique(bdates3$site_name)[i]
  groupdat$start <- segdat[seq(1, nrow(segdat), 2), "X95."]
  groupdat$end <- segdat[seq(2, nrow(segdat), 2), "X95."]
  groupdat$group <- seq(1:length(dat$hdr[c(TRUE, FALSE)]))
  groupdat$year_median <- dat$mode

  hdrdat <- rbind(hdrdat, groupdat)
}


hdrdat <- hdrdat[order(hdrdat$year_median, decreasing = TRUE),]
hdrdat$site_name <- factor(hdrdat$site_name, levels = unique(hdrdat$site_name))

prevdates <- prevdates[order(match(prevdates$site_name, hdrdat$site_name)),]
prevdates$site_name <- factor(prevdates$site_name,
                            levels = unique(prevdates$site_name))
prevdates$site_name <- as.character(prevdates$site_name)

tabdat <- left_join(prevdates, hdrdat, by = "site_name")

redat <- left_join(tabdat, sitdat, by = c("site_name" = "name")) %>% 
  arrange(site_name) %>% 
  group_by(site_name) %>% 
  mutate(start95 = plyr::round_any(min(start.y), 10),
         end95 = plyr::round_any(max(end.y), 10)) %>% 
  # Replace minus sign/not minus sign with BCE/CE
  mutate(start.x = ifelse(grepl("^[-]", start.x), 
            gsub("^[-]", "", start.x), 
            gsub("$", " CE", start.x)),
         end.x = ifelse(grepl("^[-]", end.x), 
            gsub("^[-](.*)", "\\1 BCE", end.x), 
            gsub("$", " CE", end.x)),
         end95 = ifelse(grepl("^[-]", end95), 
            gsub("^[-](.*)", "\\1 BCE", end95), 
            gsub("$", " CE", end95))) %>%
  mutate(start95 = ifelse(str_detect(end95, "BCE"),
                          ifelse(grepl("^[-]", start95), 
            gsub("^[-](.*)", "\\1", start95), 
            gsub("$", "", start95)),
            ifelse(grepl("^[-]", start95), 
            gsub("^[-](.*)", "\\1 BCE", start95), 
            gsub("$", "CE", start95)))) %>% 
  mutate(elev = paste0(min_elev, "\u2013", max_elev),
         repdate = paste0(start.x, "\u2013", end.x),
         hdrdate = paste0(start95, "\u2013", end95)) %>% 
  select(site_name, elev, repdate, hdrdate, reference)

redat[match(unique(redat$site_name), redat$site_name),] %>% 
   rowid_to_column("id") %>% 
   kable(caption = "Shoreline dating previously shorline dated sites. The range of the 95\\% HDR is rounded off to the nearest 10 years to reduce spurious precision.",
         col.names = c("", 
                     "Site",
                    "Elevation",
                    "Reported date",
                    "95% HDR",
                    "Reference"),
        booktabs = TRUE,  linesep = c(""), escape = TRUE, longtable = TRUE)
  
```


\newpage

## References {-}

::: {#refs}
:::
