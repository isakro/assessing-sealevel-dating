---
title: "A simulation-based assessment of the relation between Stone Age sites and relative sea-level change along the Norwegian Skagerrak coast"
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [UiO]
      correspondence: true
institute:
  - UiO: University of Oslo, Institute of Archaeology, Conservation and History
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::pdf_document2:
      toc: false
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

knitr::opts_knit$set(
  eval.after = "fig.cap"
)
```

```{r libraries, eval = TRUE, results = 'hide'}
library(here)
library(tidyverse)
library(sf)
library(ggridges)
library(ggthemes)
library(ggnewscale)
library(patchwork)
library(terra)
library(raster)
library(oxcAAR)
library(vapour)
library(topoDistance)
library(IRanges)
library(stringr)
quickSetupOxcal()

# Set up so that I can call floatbarrier using regfloat=TRUE in the chunk 
# headings. See: 
# https://gist.github.com/burchill/8873d2ade156b27e92a238a774ce2758
knitr::knit_hooks$set(plot = function (x, options) {
  float_correct <- function(f, y, opts)  {
    if (is.null(opts$regfloat) || opts$regfloat==FALSE)
      paste0(f(y, opts), "\n\n\\FloatBarrier\n")
    else
      f(y, opts)
  }
  if (!is.null(options$out.width) || !is.null(options$out.height) ||
      !is.null(options$out.extra) || options$fig.align != "default" ||
      !is.null(options$fig.subcap)) {
    if (is.null(options$fig.scap))
      options$fig.scap = NA
    return(float_correct(knitr:::hook_plot_tex, x, options))
  }
  return(float_correct(knitr:::hook_plot_md_base, x, options))
})
```

```{r get-data-functions, include = FALSE}
# For reproducibility
set.seed(123)

# Load all sites and radiocarbon data
sites <- read.csv(here('analysis/data/raw_data/sites.csv'))
rcarbon <- read.csv(here('analysis/data/raw_data/radiocarbon.csv'))

# Background map
bmap <- st_read(here('analysis/data/raw_data/naturalearth_countries.gpkg'))

# Digital terrain model
dtm <- rast("/home/isak/phd/eaa_presentation/dtm10/dtm10.tif")

# Load processed site and radiocarbon data, and load functions
load(here("analysis/data/derived_data/01data.RData"))
load(here("analysis/data/derived_data/02data.RData"))
load(here("analysis/data/derived_data/06data.RData"))
source(here("analysis/script/04script.R"), local = knitr::knit_global())

# Exclude Lunaveien and Dybdalshei 2 (See supplementary material)
sites_sa <- filter(sites_sa, !(name %in% c("Dybdalshei 2", "Lunaveien")))

```

# Introduction

The post-glacial relative sea-level fall that characterises large areas of Fennoscandia is fundamental to its archaeology. This follows not only from the dramatic changes to the landscape that this process has represented throughout prehistory, but also from the fact that if archaeological phenomena were situated close to the contemporary shoreline when they were in use, a reconstruction of the trajectory of shoreline displacement can be used to date these phenomena based on their altitude relative to the present day sea-level. This method, also called shoreline dating, has long history of use in the region and is frequently applied to assign an approximate date to diverse archaeological phenomena such as rock art, grave cairns, various harbour and sea-side constructions and, as is the focus of this study, Stone Age sites [e.g. @akerlund1996; @bjerck2005; @nordqvist1995; @sognnes2003; @tallavaara2020].

The close association between Scandinavian Stone Age settlements and shifting prehistoric shorelines was becoming apparent by the end of the 19th century [@degeer1896], and was firmly established and being applied as a dating method in Sweden [@hollender1901] and Norway [@brogger1905] at the turn of the century. Shoreline dating has been fundamental to Stone Age research in Norway ever since [see for example @berg-hansen2009; @bergsvik2020; @bjerck2008; @damlien2021]. The method is used both independently, and to compliment other sources of temporal data such as typological indicators or radiometric dates. However, given the coarse and fuzzy resolution of established typological frameworks, the vast amount of surveyed sites that only contain generic lithic debitage that could hail from any part of the period, and as the conditions for the preservation of organic material is typically poor in Norway, dating with reference to shoreline displacement is often the only and most accurate method by which one can hope to date the sites. Shoreline dating is consequently fundamental to our understanding of the Norwegian Stone Age. This is both because it is central to the temporal framework on which our understanding of the period is based, but also because the method is only applicable so long as the societies in question have continuously settled on or close to the contemporary shoreline. Consequently, adherence or deviation from this pattern also has major implications for the socio-economic foundations of the societies in question.

Despite its important role for Norwegian Stone Age archaeology, the applicability of dating by reference to shoreline displacement has only been evaluated using relatively coarse methods. The aim of this paper is to provide a systematic and comprehensive review of the degree to which radiocarbon dates correspond with the dates informed by our current knowledge of shoreline displacement in a larger area of south-eastern Norway, using a more refined methodological approach. The goal is to quantify the degree to which the assumption of shore-bound settlement holds through the Stone Age, and in turn have this inform a refined method for shoreline dating. As presented in more detail below, this problem involves the combined evaluation of three major analytical dimensions. One is the questions of when the sites were in use, the second pertains to the reconstruction of the contemporaneous sea-level, and the third follows from the fact that the relation between site and shoreline is inherently spatial. Taking inspiration from studies that have integrated various sources of spatio-temporal uncertainty through Monte Carlo simulation [@bevan2013a; @crema2012; @crema2010; @crema2015; @yubero-gomez2016], a similar approach is adopted here.

# Background

Relative sea-level (RSL) can be defined as the mean elevation of the surface of the sea relative to land, or, more formally, the difference in elevation between the geoid and the surface of the Earth as measured from the Earth's centre [@shennan2015]. Variation in this relative distance follow from a range of effects [e.g. @milne2009; @mörner1976]. Of central importance here is eustasy and glacial istostasy. The eustatic sea-level is understood as the sea-level if the water has been evenly distributed across the Earth's surface without adjusting for variation in the rigidity of the Earth, its rotation, or the self-gravitation inherent to the water body itself [@shennan2015]. The eustatic sea-level is mainly impacted by glaciation and de-glaciation, which can bind or release large amounts of water into the oceans, as well as by changes in the Earth's crust that impact the volume of ocean basins. Istostasy, on the other hand, pertains to adjustments in the crust to regain gravitational equilibrium relative to the underlying viscous mantle. This is often the result of glacial istostasy, which follows from glaciation and de-glaciation and corresponding loading and unloading of weight, as well as from erosion of the crust, which causes its weight to be redistributed. These effects thus causes the lithosphere to either subside due to increased weight, or to rebound and lift upwards due to lower weight [@milne2015].

Following the end of the Weichselian and the final retreat of the Fennoscandian Ice Sheet [e.g. @hughes2016; @stroeven2016, see Figure \@ref(fig:deglaciation)], the isostatic rebound has been so severe that most areas of Norway have been subject to a continuous relative sea-level regression, despite corresponding eustatic sea-level rise [e.g. @svendsen1987; @mörner1979]. In other words, the RSL has been dropping throughout prehistory. As this process is the result of glacial loading, the rate of uplift is more severe towards the centre of the ice sheet. Thus, some areas on the outer coast have had a more stable RSL or been subject to marine transgression [e.g. @romundset2015; @svendsen1987]. These conditions are directly reflected in the archaeological record. In areas where the sea-level has been stable over longer periods of time, people have often reused coastal site locations multiple times and over long time-spans, creating a mix of settlement events that are difficult to disentangle [@reitan2009]. Transgression phases, on the other hand, can lead to complete destruction of the sites, or bury them in marine sediments, leading to a hiatus in the archaeological record for certain sub-phases in the impacted areas [@bjerck2008; @glorstad2020]. Comparatively, given a continuous and still ongoing shoreline regression from as high as c. 220 m above present sea-level in the inner Oslo fjord, any one location in south-eastern Norway has only been shore-bound within a relatively limited time-span, and the sites have not been impacted by any transgressions [@hafsten1957; @hafsten1983; @sørensen1979]. This makes the region especially useful for evaluating the assumption of a shore-bound settlement over a long and continuous time-span.

```{r deglaciation, echo = FALSE, fig.cap = "Deglaciation at 1000 year intervals from c. 17--8 kyr BCE (data from Hughes et al. 2016). The study area defined later in the text is marked with a red outline.", out.width = "400px", fig.align="center", regfloat=TRUE}

knitr::include_graphics(here("analysis/figures/deglaciation.png"))

```

The shore-bound settlement location of prehistoric hunter-fisher-gatherers in Norway is generally believed to follow both from the exploitation of aquatic resources and from movement and communication, which would have been efficient on waterways. The same logic has also been extended to the hinter- and inland regions, where sites are to be located along rivers and lakes [@brogger1905; @glorstad2010, 57--87; but see @mjærum2018; @gundersen2013; @schulke2020]. This is to take a dramatic turn at the transition to the Late Neolithic, around 2400 BCE, with the introduction of the Neolithic proper [@solheim2021; @prescott2020]. The shift to agro-pastoralism and the introduction of the farm led the site locations to be more withdrawn from the shoreline [e.g. @bakka1971; @prescott2012; @ostmo2008, 223]. That is not to say that waterways and aquatic resources were no longer exploited, but rather that these activities would not have been as tightly integrated with settlement and tool-production areas as in preceding periods [@glorstad2011a]. At an earlier stage, at the transition to the Early Neolithic (c. 3900 BCE), pottery is introduced to the sites, and there are some indications of an initial uptake of agriculture at some sites in the Oslo fjord region. However, this appears to be small in scale and is believed to be combined with a continued and predominantly hunter-gatherer life-way, possibly followed by a complete de-Neolithisation in the Middle Neolithic [@nielsen2019; @hinsch1955]. @nielsen2021b has recently argued that the initial uptake of agriculture in the Early Neolithic is combined with a more complex settlement pattern, and that a simple forager/farming dichotomy would underplay the variation present in the Early and Middle Neolithic data [see also @amundsen2006; @solheim2012, 74]. Seen in relation to the question of interest here, the empirical expectation for the above outlined development would thus be a more varied association between sites and the shore-line from around 3900 BCE, followed by a more decisive shift around 2400 BCE with a comprehensive Neolithisation.

[@breivik2014; @solheim2018]

Based on the generally accepted premise that most pre-Late Neolithic sites in south-eastern Norway located lower than the marine limit were situated on or close to the contemporaneous shoreline, it is common to err on the side of a shore-bound site location unless there is strong evidence to suggest otherwise. This is for example common in survey projects, which are often guided by a both a digital and mental reconstruction of past sea-levels. Similarly, following an excavation, if typological indicators in the assemblages correspond with available shoreline displacement curves it is common to assume a shore-bound site location, even if the typologically informed date-span is too wide to decisively verify this. It is also common to combine this with a qualitative consideration of the landscape surrounding the sites, and an evaluation of the degree to which the site location would have been sensible if the site was not shore bound [e.g. @jaksland2014; @nummedal1923]. This can for example pertain to accessibility. If the site is situated on a ledge in a steep and jagged area of the present day landscape, or if it would have been located on an island when the sea-level was higher, it would make intuitive sense that the site was in use when the ocean reached closer to its elevation, as the site would have been accessible by means of watercraft. Although it appears that the arguments for such site locations are sensible and can for the most part be assumed to hold, comprehensive evaluations and attempts at quantification of this tendency are few, and are typically conducted on a site-by-site or project-by-project basis, meaning the basis for assuming shore-bound site location is largely a mosaic of smaller scale investigations.

One of the more comprehensive evaluations of this relationship was done by Solheim and colleagues [@breivik2018; @solheim2020], who compared 102 ^14^C-dates from 33 Mesolithic sites on the western side of the Oslo fjord to the displacement curve for the Larvik area. They found an overlap between the probability density of the radiocarbon dates with the shoreline displacement curve for 86.5% of the sites. However, where there was a discrepancy, the main occupation of the sites are still believed to have been shore-bound rather than associated with the deviating ^14^C-dates. This is based on typological and technological characteristics of the assemblages. Whether these mismatches represent later shorter visits that are responsible for the younger radiocarbon dates, or whether these are entirely erroneous results of contamination can be difficult to evaluate [@schulke2020], but this distinction is not critical here. What is of interest is the relation between settlments and tool-production areas and the shoreline, and not has argued that some of these deviating dates could represent later visits that due to the    The evaluation of the radiocarbon dates will here be entirely dependent on, and follow the discretion of the original excavation reports. 

Other previous evaluations of the correspondence between radiocarbon- and RSL-informed dates have typically followed the same structure as that of @breivik2018, involving a visual inspection of radiocarbon probability density functions plotted against local shoreline displacement curves based on the elevation of the site [e.g. @åstveit2018; @solheim2020]. This approach has a couple of limitations. First of all, the displacement curves are commonly applied directly to larger study areas, with only a few studies having taken the variable uplift-rates into account when performing this comparison [e.g. @fossum2020; @møller1987; @persson2008]. Secondly, with this method, the wider the uncertainty range associated with either radiocarbon date or displacement curve, the higher the probability that the confidence intervals overlap, and the higher the probability that we conclude in favour of our hypothesis. This thus leads to an inferential framework that favours uncertainty, which is hardly desirable. In statistical terms this follows from the fact that while one cannot conclude that two dates are different if their confidence intervals overlap, this does not necessarily mean that they are the same. The question thus necessitates a flip from a null-hypothesis of no significant difference, to one of equivalence [e.g. @lakens2018], as the question of interest is effectively one of synchroneity between events [cf. @parnell2008]. Another limitation of this often-employed method is that it only takes into account the vertical distance between the sites and the sea-level. While this is the main parameter of interest for shoreline dating, the practical implications of a vertical difference in RSL will be highly dependent on local topography and bathymetry. RSL-change can have more dramatic consequences in a landscape characterised by a low relief, as the horizontal displacement of the shoreline will be greater. Taking the spatial nature of the relationship between site and shoreline into account will consequently help get more directly at the behavioural dimension of this relation, and move the analysis beyond a purely instrumental consideration of the applicability of shoreline dating. Suggested ways to help mitigate and integrate the issues presented above into to the analysis are presented in the methods section.

# Data
To get at the relationship between sites and the contemporaneous shoreline, this analysis is dependent on a study area with good control of the trajectory of prehistoric shoreline displacement. While there is displacement data available for other areas of south-eastern Norway [e.g. @hafsten1957; @sørensen1979; @sørensen1999], considerable methodological developments in recent years means that the most well-established displacement curves are from the region stretching from Horten county in the north-east, to Arendal in the south-west. This area has newly compiled displacement curves for Horten [@romundset2021], Larvik [@sørensen2014; @sørensen2014b; @sorenseninpress], Tvedestrand [@romundset2018; @romundset2018b], and Arendal [@romundset2018b].

The employed shoreline displacement curves are all based on the so-called isolation basin method [@romundset2011]. This involves extracting cores from a series of basins situated on bedrock at different elevations beneath the marine limit, and dating the transition from marine to lacustrine sediments in the cores. Each curve is thus construed from a series of cored basins located at different elevations, each representing a high precision sea-level index point. Furthermore, to minimise the impact of variable uplift rates, the basins are located in a as constrained area of the landscape as possible. Following from the morphology of the retreating ice sheet, the uplift is more severe towards the north-east, meaning that this needs to be adjusted for in the case that any basins are located a significant distance from a common isobase perpendicular to this gradient. The confidence bands of the displacement curves and their trajectory are quite complex constructs, and are the integrated result of both expert knowledge and more objectively quantifiable parameters. The reason for this is in part that the curves do not only contain uncertainty as related to radiometric dates, which are well defined, but also hold potential error as related to the interpretation and analysis of sediment cores, the nature and condition of the basin outlets and the adjustment to a common isobase, to name but a few [e.g. @romundset2019; @romundset2011]. For more details and evaluations done for the compilation of each curve, the reader is therefore referred to the individual publications.

The archaeological data compiled for the analysis consists of all excavated Stone Age sites with available spatial data from the coastal region between Horten county in the north-east, to Arendal in the south-west (Figure \@ref(fig:map-iso)). These number a total `r nrow(sites)` sites. Of these, `r length(unique(rcarbon$site_name))` sites are associated with a total of `r nrow(rcarbon)` radiocarbon dates. Of these, in turn, `r nrow(sites_sa)` sites are related to the `r nrow(rcarb_sa)` radiocarbon dates that fall within the Stone Age (9500--1700 BCE) with 95 % probability. These sites and ^14^C-dates form the basis for the analysis. Spatial data in the form of site limits and features, as defined by the excavating archaeologists, were retrieved from local databases at the Museum of Cultural History---the institution responsible for archaeological excavations in the region. In the compiled dataset, each radiocarbon date has been associated with the site features or excavation unit from where they originate, or, where these weren't available, the spatial limit of the entire site. Due to somewhat variable practices between excavations, what available spatial geometry best represents the site limit was decided based on an evaluation of the excavation reports. This means that the limits are variably given as that defined during initial survey, area de-turfed before excavation, area stripped with excavator following the excavation, manually excavated area, or convex hull polygons generated around the site features.

Three of the sites have been associated with farming activities, either in directly or in the form building structures. The first is Nordby 1, at which the ^14^C-dates are associated with a Late Neolithic long-house. The Middle Neolithic phase at Kvastad A2 and Late Neolithic phase at Nauen A are both related to farming. Both of these sites also have radiocarbon dates and lithic inventory associated with Mesolithic forager activities. Following from the expected deviance from the settlement patterns that are to characterise forager sites, these agricultural phases are thus treated separately below. Finally, @nielsen2021b has recently suggested that Early and Middle Neolithic features from the otherwise younger sites Bratsberg and Larønningen could be related to early agricultural activity in the Oslo fjord region. Due to the uncertain and somewhat speculative nature of this suggestion, these are omitted here.

[Table with sites]

The elevation data used for the analysis is a digital terrain model (DTM) freely available from the Norwegian Mapping Authority [@mapping2019]. It was here opted for the 10m resolution DTM rather than the higher-resolution 1m version. In addition to resulting in considerably less processing time, the higher resolution elevation model is more vulnerable to smaller-scale modern disturbances that the 10m version is not impacted by. The 10m DTM is a down-sampled version of the 1m resolution DTM, which is based on aerial laser scanning using a minimum of two and up to five points per m^2^ and has a vertical error of  [@mapping2019].  

All data and R programming code [@rcoreteam2021] required to run the analyses, as well as the derived data are freely available in an online repository at <https://osf.io/7f9su/>, organised as a digital research compendium following @marwick2018. The dataset is slightly more extensive than what is directly utilised in the study, and includes excavated sites without ^14^C-dates within the study area, as well as ^14^C-dates to periods other than the Stone Age.

```{r map-iso,  fig.cap = paste("A) Distribution of the ", nrow(sites_sa), " analysed sites relative to the isobases of the displacement curves. The isobases have a direction of 327$^{\\circ}$ (Romundset et al. 2018), B) Displacement curves. Note the increasing steepness of the curves towards the north-east."), fig.height = 13, regfloat=TRUE}
bboxsites <- st_bbox(sites_sa)
bboxsites[1] <- bboxsites[1] - 15000
bboxsites[3] <- bboxsites[3] + 15000
bboxsites[2] <- bboxsites[2] - 5000
bboxsites[4] <- bboxsites[4] + 5000
bboxsitespoly <- st_as_sf(st_as_sfc(bboxsites))

bound_reproj <- st_transform(bboxsitespoly, st_crs(bmap))
bmap2 <- bmap %>%
    filter(st_intersects(., bound_reproj, sparse = FALSE))
bmap_reproj <- st_transform(bmap2, st_crs(sites_sa))

anc <- as.numeric(c(bboxsites$ymin, bboxsites$xmax))
overview_map <- ggplot() +
  geom_sf(data = bmap_reproj, fill = "grey", colour = NA) +
  geom_sf(data = isobases, aes(colour = name)) +
  geom_sf(data = st_centroid(sites_sa), fill = "red",
          size = 2.25, shape = 21,
          colour = "black") +
  ggsn::scalebar(data = sites_sa, dist = 20, dist_unit = "km",
                 transform = FALSE, st.size = 4, height = 0.02,
                 border.size = 0.1, st.dist = 0.03,
                 anchor = c(x = anc[2] - 15500, y = anc[1]) + 8000) +
  coord_sf(xlim = c(bboxsites[1], bboxsites[3]),
           ylim = c(bboxsites[2], bboxsites[4]),
           expand = FALSE) +
  scale_colour_manual(values = c("Arendal" = "black",
                                   "Larvik" = "darkgreen",
                                   "Tvedestrand" = "blue",
                                   "Horten" = "darkorange")) +
  theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank(),
                     legend.position = "none") 

disp_curves <- ggplot(displacement_curves, aes(x = years, col = name)) +
  geom_line(aes(y =  upperelev)) +
  geom_line(aes(y = lowerelev)) +
  ylab("Meters above present sea-level") +
  xlab("cal BCE/CE") +
  scale_colour_manual(values = c("Arendal" = "black",
                                   "Larvik" = "darkgreen",
                                   "Tvedestrand" = "blue",
                                   "Horten" = "darkorange")) +
  theme_bw() +
  theme(legend.title = element_blank(), legend.position = "bottom",
        legend.direction = "horizontal")


overview_map / disp_curves
```

# Methods

The goal of this study is effectively to evaluate the spatial relationship between two phenomena, sites and shorelines, each associated with their own range of temporal uncertainty. The first task was therefore to ascribe likely date ranges and associated uncertainty to the two phenomena. To take account of the gradient in the isostatic rebound, the trajectory of shoreline displacement was interpolated to each site location from the displacement curves using inverse distance weighting based on the distance between the site and the isobases of the displacement curves [e.g. @conolly2020; @conolly2006,94--97]. This was done for each year along the entirety of the curves using the standard squared inverse of the distances. The result of this process is shown for an example site in Figure \@ref(fig:example-1). For the date ranges associated with the sites, all radiocarbon dates were first individually calibrated using the IntCal20 calibration curve [@reimer2020] using OxCal v4.4.4 [@bronkramsey2009] through the oxcAAR package for R [@hinz2021]. Radiocarbon dates associated with each site were then grouped if they overlapped with 99.7 % probability, meaning these were effectively taken to represent the same settlement phase. In the case where there are multiple dates believed to belong to a single phase, these were subjected to Bayesian modelling using the Boundary function in OxCal and then summed. Multiple phases at a single site were treated as independent of each other.

As the excavation of archaeological sites typically follow from residential and commercial development, as well as the expansion of infrastructure, the area immediately surrounding the sites have sometimes been severely impacted by modern disturbances. In addition to employing 10m resolution DTM to alleviate some of these issues, this also necessitated some additional editing of the elevation raster. This involved manually defining the extent of problem areas such as railways, highways, quarries and the like. The DTM values on these were then set to missing, and new elevation values were interpolated from the surrounding terrain. This was done using regularised spline interpolation with tension [e.g. @conolly2020], using the default settings of r.fillnulls from GRASS GIS in R through the package rgrass7 [@bivand2021]. In addition to code and original spatial data being available in the research compendium for this paper, it has also been noted in the supplementary material when the area surrounding a site has been edited in this manner.

Armed with a likely date range for the occupation(s) of each site, an estimated trajectory of relative sea-level change at that location, and a DTM edited to remove substantial modern disturbances, the simulations were performed. A single simulation run involved first drawing a single year from the posterior density estimate of a given occupation phase of a site (Figure \@ref(fig:example-2)). This year then has a corresponding likely elevation range for the contemporaneous shoreline from which an elevation value was drawn uniformly, using intervals of 5cm. The sea-level was then raised to this elevation on the DTM by defining all elevation values at or below this altitude as missing. Polygons were then created from the resulting areas with missing values. The horizontal distance was then found by measuring the shortest distance between site and sea polygons, and the vertical distance by subtracting the elevation of the sea-level from the lowest elevation of the site polygon. The topographic distance between site and sea was also found by measuring the shortest distance while taking into account the slope of the terrain on the DTM. This was done using the topoDistance package for R [@wang2019]. The topographic distance was measured between site polygon and the horizontally closest point on the shoreline. This means that the distance is not necessarily measured as the closest topographic distance to the shoreline, but rather as the shortest topographic path to the horizontally closest point on the shoreline. Not finding the topographically closest point significantly reduced the computational cost of the analysis, and is deemed unlikely to have a considerable impact on the results, given the distances considered. The shortest topographic path was found using the Moore neighbourhood of eight cells [e.g. @conolly2006, 253; @herzog2013]. In the case where the sea-polygons intersects the site polygon, all distance measures were set to zero. In the case that the sea-polygon completely contain the site, the horizontal and topographic distance measures were made negative, and the vertical distance was instead measured to the highest point on the site polygon. While it is safe to assume that an archaeological site was not occupied when it was located beneath sea-level, a negative result can reflect the inherent uncertainty in this procedure, and might also help identify discrepancies in displacement data or radiocarbon dates. Negative values were therefore retained, with the exception of for the sites Gunnarsrød 5 and Pjonkerød R1, where the negative values are believed to result from modern disturbances in the DTM rather than the ^14^C-dates or displacement curves (see supplementary material for more details).

This process was repeated 1000 times for each phase for each site. The choice of 1000 simulation runs follows from an evaluation of when the mean distances between site and shoreline converged when running 5000 iterations of the simulation on the site Hovland 5, available in the supplementary material. Hovland 5 was chosen for this evaluation as it has a fairly uncertain date range, and is located in area of quite complex topography. At 1000 simulation runs the analysis of each site took up to a few hours, depending on the distance to the simulated shorelines and the necessary size of the window of analysis.

```{r example-site, fig.show='hide'}
# Specify site name
sitename <- "Hegna vest 1"

# Group dates that overlap with 99.7 % probability using the group_dates()
# function. All functions in this chunk where package isnt specified are defined 
# in 04script.R
date_groups <- group_dates(rcarb_sa, sitename)

# Retrieve site limit and site features
siter <- dplyr::filter(rcarb_sa, site_name == sitename)
sitel <- dplyr::filter(sites_sa, name == sitename)

# Creating bounding box at 400 meters
location_bbox <- bboxpoly(sitel, 400)

# Clip DTM with the bbox
sitearea <- terra::crop(dtm, location_bbox)

# Model dates using the Boundary function in OxCal
datedat <- model_dates(sitedates = siter, date_groups = date_groups)

# Find local displacement curve
sitecurve <- interpolate_curve(years = xvals,
                                 target = sitel,
                                 dispdat = displacement_curves,
                                 isodat = isobases)
# Add site name
sitecurve$name <- sitename

# Plot of dates
date_plot <- plot_dates(datedat, sitename, title = FALSE)
site_map <- site_plot(sitearea, sitel, 150, date_groups,
                      s_tdist = 0.5, s_xpos = 175,
                       s_ypos = 85,  s_bheight = 0.3, s_tsize = 3)
overview_map <- overview_plot(bmap, sitel, sites_sa, isobases,
                               os_tdist = 0.03, os_xpos = 20000, os_ypos = 8000,
                               os_bheight = 0.02, os_tsize = 3)


curve_plot <- ggplot() + 
              geom_line(data = displacement_curves, 
                        aes(x = years, y = upperelev, col = name)) +
  geom_line(data =  displacement_curves, 
                        aes(x = years, y = lowerelev, col = name)) +
  geom_line(data = sitecurve,
            aes(x = years, y = upperelev, col = name)) +
  geom_line(data = sitecurve,
            aes(x = years, y = lowerelev, col = name)) +
  scale_colour_manual(values = c("Arendal" = "black",
                                   "Larvik" = "darkgreen",
                                   "Tvedestrand" = "blue",
                                   "Horten" = "darkorange",
                                 "Hegna vest 1" = "red")) +
  ylab("Meters above present sea-level") +
  xlab("cal BCE/CE") +
  theme_bw() +
  theme(legend.title = element_blank(), legend.position = "bottom",
        legend.direction = "horizontal")


plt <- (site_map + date_plot) /
(overview_map + curve_plot) +
  plot_annotation(tag_levels = 'A')

# It was easier to get correct dimensions by saving and then 
ggsave(file = here("analysis/figures/example_map.png"), plot = plt, width = 250,
       height = 76 + (76 * length(unique(date_groups))),
       units = "mm")

```

```{r example-1, echo = FALSE, fig.cap = "Example site Hegna vest 1 (Fossum 2017). A) Location of the site in the present day landscape. The red outline is the site limit. B) Radiocarbon dates associated with the site. Fill colour indicates what dates are assumed to belong to the same settlement phase. Multiple dates are modelled using the Boundary function in OxCal and then summed. The red outline indicates that the date does not match the typological indicators in the artefact assemblage of the site. C) The location of the site within the study area relative to isobases of the employed displacement curves. D) Displacement curve interpolated to the site location.", out.width = "500px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/example_map.png"))
```

```{r example-site-cont2, fig.show='hide'}
# Retrieve example date to be used. The posterior sum of date group 1
posteriorprobs <- filter(datedat, group == 1 & class == "sum")

# Set up to sample a single year
samplingframe <- list(x = posteriorprobs[["dates"]],
                      y = posteriorprobs[["probabilities"]])

# Draw a single year
sdate <- round(with(samplingframe, sample(x, size = 1, prob = y)))

# Create plot showing the year drawn from the posterior sum
datsamp <- ggplot(posteriorprobs) +
  ggridges::geom_ridgeline(aes(x = dates, y = name,
                               height = probabilities * 50),
                           fill = "lightgrey") +
  # Create segment to indicate which year was drawn
  geom_segment(aes(x = sdate, xend = sdate, y = as.numeric(as.factor(name)),
                   yend = as.numeric(as.factor(name)) +
                     (posteriorprobs[round(dates) == sdate,
                                     "probabilities"]) * 50),
               colour = "red") +
  labs(x = "cal BCE")  +
  #scale_y_discrete(expand = c(0.01, 0)) +
  theme_bw() + theme(
    legend.position = "none",
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank()
  ) +
  scale_x_continuous(breaks = sort(c(-8200, -8000, sdate, -7600)))

# Find upper and lower shoreline elevation at sdate
uppers <- round(approx(sitecurve[,"years"], sitecurve[,"upperelev"],
                       xout = sdate)[["y"]], 1)
lowers <- round(approx(sitecurve[,"years"], sitecurve[,"lowerelev"],
                       xout = sdate)[["y"]], 1)

# Draw sea-level uniformly from elevation range, intervals of 5 cm
sealevel <- sample(seq(lowers, uppers, 0.05), 1)

# Plot the drawn elevation on the displacement curve
elevsamp <- ggplot(sitecurve, aes(x = years)) +
  geom_line(aes(y =  upperelev), colour = "red") +
  geom_line(aes(y = lowerelev), colour = "red") +
  ylab("Meters above present sea-level") +
  xlab("cal BCE/CE") +
  theme_bw() +
  theme(legend.title = element_blank(), legend.position = "bottom",
        legend.direction = "horizontal") +
  geom_segment(aes(x = sdate, xend = sdate, y = uppers,
                                           yend = -Inf), col = "black",
                size = 0.25, linetype = "solid") +
  geom_segment(aes(x = -Inf, xend = sdate, y = uppers,
                   yend = uppers), col = "black", size = 0.25) +
  geom_segment(aes(x = -Inf, xend = sdate, y = lowers,
                   yend = lowers), col = "black", size = 0.25) +
  geom_segment(aes(x = -Inf, xend = sdate, y = lowers,
                   yend = lowers), col = "black", size = 0.25) +
  geom_segment(aes(x = -Inf, xend = sdate, y = sealevel,
                   yend = sealevel), col = "red", size = 0.25,
               linetype = "dashed") +
  annotate("text", x = -8700, y = uppers + 3.5, label = as.character(uppers)) +
  annotate("text", x = -8700, y = lowers - 3.5, label = as.character(lowers)) +
  scale_x_continuous(breaks = sort(c(sdate, -6000, -3000, 0))) +
  scale_y_continuous(breaks = sort(c(0, sealevel, 100)))

# Adjust sea-level on DTM
rclmat <- matrix(c(sealevel, Inf, NA, 0, sealevel, 1),
                 ncol = 3, byrow = TRUE)
classarea <- terra::classify(sitearea, rclmat)
seapoly <- st_combine(st_as_sf(terra::as.polygons(classarea)))


# Retrieve lowest elevation on polygon
siteelev <- extract(sitearea, vect(sitel), fun = min)[2]
# Find difference to sea-level elevation
vertdist <-  min(siteelev[1:nrow(siteelev),]) - sealevel

# Find the nearest points on the site- and seapolygons,
distline <- st_nearest_points(sitel, seapoly)

# Retrieve the two points
distpts <- st_cast(distline, "POINT")

# Find topographic distance
coords <- rbind(st_coordinates(distpts[1]),
                st_coordinates(distpts[2]))
rownames(coords) <- c("loc", "sea")

# Find topographic distance (retrieve path)
topodist <- topoDist(raster::raster(sitearea), coords,
                     paths = TRUE)
# Store distance
tdist <- topodist[[1]]["loc", "sea"]

# Retrieve path
tpath <- st_as_sf(topodist[[2]])

# Find end-points
endptns <- st_line_sample(tpath, sample = c(0, 1))

# Cast as line
hordistl <- st_cast(endptns, "LINESTRING")

# Find horizontal distance
hordist <- st_length(hordistl)

# Create hillshade
# For some reason the terra version returned pathchy hillshade (probably due 
# to the defaults - I didn't bother experimenting too much as this is simply for
# the purposes of visualisation).
slope <- raster::terrain(raster(sitearea), 'slope')
aspect <- raster::terrain(raster(sitearea), 'aspect')
hill <- raster::hillShade(slope, aspect, 40, 270)

# Make the raster amenable for plotting with ggplot (as.data.frame with terra
# returned some strange errors)
raster_df <- raster::as.data.frame(raster(sitearea), xy = TRUE)
names(raster_df) <- c("x", "y", "value")

# Anchor for scale bar
anc <- as.numeric(c(st_bbox(location_bbox)$ymin, st_bbox(location_bbox)$xmax))

# Create plot showing single simulation of sea-level
seasamp <- ggplot() +
  geom_raster(data = raster::as.data.frame(hill, xy = TRUE),
                aes(x = x, y = y, fill = layer)) +
  scale_fill_gradient(low = "black", high = "grey40", na.value = NA) +
  new_scale_fill() +
  geom_raster(data = raster_df, aes(x = x, y = y, fill = value),
                alpha = 0.3) +
  scale_fill_gradient(low = "grey", high = "white", na.value = NA) +
  new_scale_fill() +
  geom_raster(data = raster_df, aes(x = x, y = y, fill = value)) +
  scale_fill_gradient(low = NA, high = NA, na.value = "white") +
  geom_sf(data = seapoly, fill = "#dbe3f3", colour = NA) +
  geom_sf(data = sitel, fill = NA, colour = "red") +
  #labs(title =  paste0("Sea-level at ", sealevel, " m above present")) +
  coord_sf(xlim = c(st_bbox(location_bbox)[1], st_bbox(location_bbox)[3]),
           ylim = c(st_bbox(location_bbox)[2], st_bbox(location_bbox)[4]),
           expand = FALSE) +
  ggsn::scalebar(data = sitel, dist = 150, dist_unit = "m",
                 transform = FALSE, st.size = 3, height = 0.3,
                 border.size = 0.1, st.dist = 0.5,
                 anchor = c(x = anc[2] - 500, y = anc[1] + 800)) +
  theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank(),
                     legend.position = "none")

# Create label of distance measures
dist_label <- paste0("Horizontal distance = ", round(hordist, 1), "m", 
                "\nTopographic distance = ", round(tdist, 1), "m",
                "\nVertical distance = ", round(vertdist, 1), "m")

anot <- ggplot() +
  theme_void() +
  annotate("text", x = 0,  y = 0, label = dist_label,
           hjust = 0.5, size = 7)

simplot <- (datsamp + elevsamp) / 
  (seasamp + anot) + plot_annotation(tag_levels = 'A')

ggsave(file = here("analysis/figures/example_sim_map.png"), plot = simplot, 
       width = 300, height = 76 + (76 * 2),
       units = "mm")

```

```{r example-2, echo = FALSE, fig.cap = "Example of a single simulation run on the site Hegna vest 1. A) The simulation starts by drawing a single year from the posterior density esimate.  B) This then corresponds to an elevation range on the interpolated displacement curve. A single elevation is drawn uniformly from this range using 5cm intervals. C) The sea-level is then adjusted on the DTM to this elevation and the various distance mesaures are found. D) The numerical result of the simulation run.", out.width = "500px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/example_sim_map.png"))
```

```{r example-site-cont3}
# Load results from running 1000 simulations
load(here("analysis/data/derived_data/hegnavest1.RData"))

dat1 <- datsamp <- ggplot(posteriorprobs) +
  ggridges::geom_ridgeline(aes(x = dates, y = name,
                               height = probabilities * 50),
                           fill = "lightgrey") +
  labs(x = "")  +
  #scale_y_discrete(expand = c(0.01, 0)) +
  theme_bw() + theme(
    legend.position = "none",
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank()
  ) 

# Map of simulated sea-levels, date group 1
simsea_plot1 <- shore_plot(sitearea, output[[1]]$simsea, sitel, 150, date_groups,
                      s_tdist = 0.5, s_xpos = 1300, s_ypos = 800,
                      s_bheight = 0.3, s_tsize = 3)

# Boxplot of distances from site to sea, date group 1
simdist_plot1 <- distance_plot(output[[1]]$results)


# Retrieve date group 2
probsdat2 <- filter(datedat, group == 2 & class == "bposterior")

dat2 <- ggplot(probsdat2) +
  ggridges::geom_ridgeline(aes(x = dates, y = name,
                                   height = probabilities * 50,
                                   fill = as.factor(group),
                                   alpha = class,
                                   colour = as.factor(rcarb_cor))) +
  labs(x = "cal BCE")  +
  #scale_y_discrete(expand = c(0.01, 0)) +
  theme_bw() + theme(
    legend.position = "none",
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank()
  ) +
      scale_colour_manual(breaks = c("f", "t", NA),
                         values = c("red", "black", "yellow")) +
      scale_alpha_manual(values = c("aprior" = 0.05,
                                    "bposterior" = 0.4,
                                    "sum" = 1)) +
  scale_fill_manual(
      values = as.character(ggthemes_data$colorblind[2, 2]))



# Plot of date group 2

# Map of simulated sea-levels, date group 2
simsea_plot2 <- shore_plot(sitearea, output[[2]]$simsea, sitel, 150, date_groups,
                      s_tdist = 0.5, s_xpos = 1300, s_ypos = 800,
                      s_bheight = 0.3, s_tsize = 3)

# Boxplot of distances from site to sea
simdist_plot2 <- distance_plot(output[[2]]$results)

simresultplot <- (dat1 + simsea_plot1 + simdist_plot1) /
(dat2 + simsea_plot2 + simdist_plot2) 

ggsave(file = here("analysis/figures/example_sim_result.png"),
       plot = simresultplot,  width = 250, height = 76 + (76 * 2),
       units = "mm")

```

```{r example-3, echo = FALSE, fig.cap = "The result of 1000 simulation runs for each of the two groups of dates on the site Hegna vest 1. The first column of plots shows the radiocarbon probability density estimate from where dates were drawn during simulation. The second column displays the result of simulating the raised sea-level 1000 times. The more opaque the colour, the more times the sea-level was simulated to that location. The third column shows violin plots of the different distance measures across all simulations.", out.width = "500px", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/example_sim_result.png"))
```

```{r distances}
distances2 <- distances %>%
  filter(year <= -2500 & rcarb_cor == "t" & type == "forager") %>% 
  mutate(hordist = ifelse(hordist < 0, 0, hordist),
         topodist = ifelse(topodist < 0, 0, topodist),
         vertdist = ifelse(vertdist < 0, 0, vertdist))

distances3 <- distances %>%
  filter(year <= -4000 & rcarb_cor == "t" & type == "forager") %>% 
  mutate(hordist = ifelse(hordist < 0, 0, hordist),
         topodist = ifelse(topodist < 0, 0, topodist),
         vertdist = ifelse(vertdist < 0, 0, vertdist))
```
# Simulation results

The result of running the simulations across all sites are given in Figure \@ref(fig:results). Overall, as is indicated by the measures for central tendency and the almost solid line along the 0 mark on the y-axes, most of the sites have been situated close to the shoreline when they were in use. When including all dates, also those that were believed to be erroneous in the original reports, some of the sites are situated considerable distances from the shoreline. However, if one accepts the interpretation in the reports that these dates do not date the main occupation of the sites, as indicated by the artefact inventories, the second row of Figure \@ref(fig:results) gives considerable support to the notion that the sites were in use when they were situated on or close to the contemporaneous shoreline. It is interesting to note the distance for some of the earliest sites, which appears somewhat high. This, however, can likely be explained as the result of the steepness of the displacement curves for the earliest part of the Holocene (Figure \@ref(fig:map-iso)B), which leads the uncertainty in the ^14^C-dates to give a wider possible elevation range for the sea-level. Another immediately striking result is the apparent deviation from the shoreline towards the end of the Stone Age. From around 2500 BCE several sites are situated a considerable distance from the shoreline, and while a couple remain horizontally and topographically close, most appear to be elevated a considerable distance from the sea-level, as indicated on the plot for vertical distance. This corresponds well with the literature and the suggested impact of the Neolithisation process. 

The negative values around 8000 BCE originate from the sites Løvås 1, 2 and 3. These are recently excavated, well-dated sites situated in a relatively undistributed area of the landscape. Thus, while there is a danger of circularity of having archaeological sites inform a reconstruction of the shoreline displacement, and in turn use these to evaluate the degree of shore-bound settlement, the sites do clearly represent a upper limit as they would not have been in use when located beneath sea-level. Furthermore, as the Løvås sites are located at elevations from where the local displacement curve is interpolated between isololation basins at different elevation, it would seem that the sites represent a case where the archaeological material indicates discrepancies in the geological reconstructions of shoreline displacement in the area.

Accepting that shoreline dating appears to loose utility around the transition to the Late Neolithic, as indicated by the clear deviation in site location from the shoreline after this, the results for the second row of Figure \@ref(fig:results) is given again in Figure \@ref(fig:results2), excluding all simulation results younger than 2500 BCE. Furthermore, all negative values have here been set to zero, under the assumption that these result from uncertainty or errors in the data, and not actual site locations. The resulting best point estimate for the vertical distance between site and shoreline for the pre-Late Neolithic is given by the median at `r round(median(distances2$vertdist))`m, following from the skewed distribution. 95% of the vertical distance values fall within the range `r round(quantile(distances2$vertdist, 0))`--`r round(quantile(distances2$vertdist, 0.95))`m. That is, for 95% of the cases, the shoreline was situated on or down to `r round(quantile(distances2$vertdist, 0.95))`m below the site location. This is constrained slightly when only considering the Mesolithic dates, with a median offset of `r round(median(distances3$vertdist))`m and with 95% of distance measures within the range `r round(quantile(distances3$vertdist, 0))`--`r round(quantile(distances3$vertdist, 0.95))`m. An exponential function has been fit to the distributions for vertical distance. While it is clear that this does not perfectly match the data, it would seem reasonable from a theoretical perspective to assume that a process of exponential decay explains this relationship. Furthermore, the accumulation of distances-values on the 0m mark likely follow from forcing negative values to zero, from the resolution of the spatial data, and from defining intersecting sea- and site polygon as having a distance of zero. Using the resulting exponential decay function, the sites treated here have been given a shoreline date in Figure \@ref(fig:shoredate).    


Following the general and aggregative result of this, one recommendation could be that given no other information, the method of shoreline dating should be applied with an uncertainty of 0-15m offset to the Stone Age site elevation relative to the displacement curves, following the median vertical distance and associated interquartile range. This would naturally be best applied when combined with a more comprehensive consideration of the site location, which could lead one to reduce this uncertainty, given for example surroundings where it would be reasonable to assume that a certain sea-levels would be unlikely in light of the surroundings of the site.  

Figure shows the result of shoreline dating the sites using the recommended off-set with radiocarbon dates plotted against this. The steeper the curve the more narrow the date range resulting from the procedure. This means that older siter, and sites situated towards the north-east will have a more narrow date range.

```{r results, echo = FALSE, fig.cap = "The result of running the analysis across all sites. Each data point is plotted with some transparency, meaning that the more intense the colour, the more often those values occured. Results associated with agricultural acitivites are in grey. The first row shows the result of including all dates to the Stone Age, including those seen as otherwise  unrelated to the main occupation of the sites. The second row shows the result of excluding these. The table under each plot lists some corresponding statistics for central tendency and dispersion.", out.width = "500px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/results.png"))

```

```{r results2, echo = FALSE, fig.cap = "Histograms showing distance from shoreline using dates corresponding to the site inventory. Negative values have been set to zero. The first row only includes dates older than 2500 BCE and the second row only dates older than 4000 BCE.", out.width = "525px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/results2.png"))
```

```{r shoredate, echo = FALSE, fig.cap = "The result of backwards shoreline dating the sites with radiocarbon dates corresponding to the artefact inventory. The sites are dated using the mean elevation of the site polygon, accounting for distance to closest isobase and by employing the exponential decay function identified in Figure 7 for the distance between sites and shoreline. The shoreline dates in gray are plotted against the oldest radiocarbon-informed phase for each site in black. The red line indicates the 95\\% probability range for the shoreline date.", out.width = "525px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/shoredate.png"))
```


# Shoreline dating the pioneer sites from Brunlanes

Not least following from the fact that very few pre-Boreal ^14^C-dates associated with anthropogenic activity have been achieved in Norway, the shoreline dating of the earliest sites is essential for understanding the pioneer settlement and the initial colonisation of the Scandinavian peninsula [e.g. @bang-andersen2012; @breivik2014; @glorstad2016]. The shoreline dated pre-Boreal sites from the Brunlanes-project are among the earliest known sites in Norway [@jaksland2014a; @jaksland2012; @jaksland2012a]. These have a distinct Early Mesolithic artefact inventory and are situated in a steep area of the landscape where it would be difficult to envision any use of the sites after the sea retreated any significant distance from their location. In the original publication of the sites, @jaksland2014 provides a thorough discussion of shoreline dating in general, and as used for the dating of the Brunlanes sites specifically. A comparison of his results and the ones achieved using the above-outlined approach are given in Figure Figure \@ref(fig:brunlanes)A. These are largely in agreement. The sites are located more or less on the isobase of the displacement curve for Larvik, and negligible adjustments were therefore needed. The small discrepancies between the results mainly follow from the fact that a slightly updated version of the displacement curve is applied here [cf. @sorenseninpress]. Jaksland's dates are given a flat 200 and 50 year uncertainty range starting from what he gives as the earliest possible date. The 200 year uncertainty range is given if the sites were to be considered in isolation, while the argument for the uncertainty range of only 50 years is based on the location of the sites relative to each other. Since they are located in such a constrained and steep area of the landscape, the difference in elevation between the sites is argued to establish their relative date and thus constrain the uncertainty ranges so that they don't overlap. This information is not integrated in the approach outlined here, but could justify reducing the the uncertainty ranges. The steepness of the curve does nonetheless provide very precise dates, although their accuracy is of course ultimately dependent on the veracity of the geological reconstruction. This example also highlights the fact that a consideration of the surrounding terrain and other sites can help in increasing the precision of the method if this can be used to exclude certain sea-levels as unlikely for when a site was in use. One approach to this could also be to assess the spatial implication of a proposed shoreline date by simulating the adjusted sea-levels, as is done for Pauler 1 in Figure \@ref(fig:brunlanes)B, followed for example by a visual evaluation of the topography or by measuring the steepness of the slope to the shoreline. Based on this, it could be possible to exclude certain elevations as unlikely for the position of the shoreline. Such approaches would make less of an impact in this setting, where the 95% probability range is already quite constrained, but could considerably improve the precision of the method in cases where the displacement curve is flatter (cf. Figure \@ref(fig:shoredate)). To further illustrate this point, excavated Stone Age sites in the region which have previously been dated with reference to relative sea-level change are subjected to the outlined approach below.


```{r brunlanes, echo = FALSE, fig.cap = "Shoreline dating of the Brunlanes sites using site altitudes provided by Jaksland (2014:tab.4). A) The result of applying the approach to shoreline dating outlined above. Dates provided by Jaksland (2014) are plotted in black. The box indicates a 50 year uncertainty range which in combination with the black line extends 200 years. Follwing Jaksland's approach these start from the earliest possible date. B) Map showing the centroids of the Pauler sites and Sky 1. The sea-level has been simulated using the probability density associated with the shoreline date for Pauler 1 (see also map in Jaksland 2014:fig.12a). Pauler 1 is the red point.", out.width = "525px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/brunlanes.png"))
```


# Shoreline dating

```{r redate, echo = FALSE, fig.cap = "95\\% probability ranges of shoreline dated sites in the study area without radiocarbon dates or with radiocarbon dates that do not correspond to the artefact inventories. These are comapred to the dates originally proposed by the excavation reports in black.", out.width = "525px", fig.align="center", regfloat=TRUE}
knitr::include_graphics(here("analysis/figures/redate.png"))
```


# Discussion

When no other information is available it can be recommended to apply the method for shoreline dating outlined above, which involves both taking the distance between sites and the isobase of displacement curves into consideration, and implementing to account for the distance between the sites and the shoreline. The precision of this method is, as shown above, both geographically and temporally contingent, where older sites situated towards the north-east will get a more precise date than younger sites located towards the south-west. This approach will be useful either when shoreline dating a large number of sites where no other information is available [e.g. @solheim2018; @fossum2020; @nielsen2021b; @breivik2014], which is typically done using a uniform range of uncertainty, likely overestimating the precision of the method in most cases and possibly underestimating it in some. 

The outlined approach is thus derived from the available radiocarbon record, and appears to be able to accommodate the available data. To further test the method will require independently derived radiocarbon dates.

Other information is of course typically available. 


Some sources of likely variation and uncertainty have not been considered here. First of all the DTM has only been corrected for major modern disturbances. This means that erosion, although likely not that prevalent, has not been taken into account. Secondly, the DTM has a vertical error [@lewis2021] ... Thirdly, the tidal range has not been considered...  Fourthly, the exposure of the sites to wave action is also likely to have been of concern [@roalkvam2020], and will presumably have implications for how close to the shoreline people settled [@blankholm2020]. And finally, the nature of the visits to the sites will presumably also have implications for how exposed a site. These dimensions will have implications for the shore-line dating for certain subsets of the sites and could be future avenues through which one could further improve the method. These dimensions will also be imprtant for more substantial considerations of the behavioural relation between sites and the shoreline. 

# Conclusion

The most immediate contribution of this paper is a confirmation of previous research into the relation between coastal Norwegian Stone Age sites and the prehistoric shoreline, which has largely been verified. Furthermore, the typical application of shoreline dating as an approximate method where date ranges are often for example rounded off to 200-year intervals, means that most previous research based on the method is given support by the findings reported here. However, the findings also suggest that simply using the method as a terminus ante quem for the occupation of the sites is, at least in my view, overly conservative and would stand to unnecessarily loose important chronological information. Attempting to move these considerations further through an explicit quantification has here resulted in a concrete recommendation of applying an offset of 0-15m when shoreline dating sites where no other information is available.

This quantification was achieved by means of Monte Carlo-simulation, integrating multiple sources of spatio-temporal uncertainty. Here the approach was simply used to inform the question of the distance between sites and shorelines. However, this method can be extended to a wide range of use-cases where one needs to visualise and quantitatively or qualitatively evaluate the relationship between archaeological phenomena, the prehistoric shore-line, and the uncertainty inherent in this reconstruction.

\newpage

# References

::: {#refs}
:::

<!-- \newpage -->

<!-- ### Colophon -->

<!-- This report was generated on `r Sys.time()` using the following computational environment and dependencies: -->

<!-- ```{r colophon, cache = FALSE} -->
<!-- # which R packages and versions? -->
<!-- if ("devtools" %in% installed.packages()) devtools::session_info() -->
<!-- ``` -->

<!-- The current Git commit details are: -->

<!-- ```{r} -->
<!-- # what commit is this file at?  -->
<!-- if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())   -->
<!-- ``` -->
